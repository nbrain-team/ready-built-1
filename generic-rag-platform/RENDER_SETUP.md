# Render Environment Setup Guide

## Required Environment Variables

When deploying to Render, you need to configure the following environment variables:

### 1. **DATABASE_URL** (Required)
- **What**: PostgreSQL database connection string
- **Format**: `postgresql://user:password@host:port/database`
- **How to get**: 
  1. Create a PostgreSQL database on Render (Free tier available)
  2. Copy the "Internal Database URL" from the database dashboard
  3. Add it as an environment variable

### 2. **OPENAI_API_KEY** (Required)
- **What**: Your OpenAI API key for AI responses
- **Format**: `sk-...` (starts with sk-)
- **How to get**: 
  1. Sign up at https://platform.openai.com
  2. Go to API Keys section
  3. Create a new secret key

### 3. **FLASK_SECRET_KEY** (Auto-generated)
- **What**: Secret key for session management
- **Format**: Random string (auto-generated by Render)
- **Setup**: Use Render's "Generate Value" option

### 4. **USE_MCP** (Optional)
- **What**: Enable MCP server integration
- **Default**: `true`
- **Values**: `true` or `false`

## Step-by-Step Render Setup

### 1. Create PostgreSQL Database
```
1. In Render Dashboard → New + → PostgreSQL
2. Name: generic-rag-db (or your choice)
3. Plan: Free
4. Click "Create Database"
5. Wait for provisioning (2-3 minutes)
```

### 2. Create Web Service
```
1. In Render Dashboard → New + → Web Service
2. Connect your GitHub/GitLab repository
3. Name: generic-rag-platform
4. Environment: Python 3
5. Build Command: ./build.sh
6. Start Command: gunicorn --timeout 120 'app:create_app()'
7. Plan: Choose your plan (Free tier works)
```

### 3. Configure Environment Variables
In the Web Service settings → Environment:

```bash
DATABASE_URL = [Internal Database URL from PostgreSQL]
OPENAI_API_KEY = sk-your-api-key-here
FLASK_SECRET_KEY = [Click "Generate"]
USE_MCP = true
```

### 4. Optional Environment Variables

For production use, you may also want:

```bash
# Pinecone for vector search (optional)
PINECONE_API_KEY = your-pinecone-key
PINECONE_ENVIRONMENT = your-pinecone-env

# AWS S3 for file storage (optional)
AWS_ACCESS_KEY_ID = your-aws-key
AWS_SECRET_ACCESS_KEY = your-aws-secret
S3_BUCKET_NAME = your-bucket-name

# Custom configuration
FLASK_ENV = production
LOG_LEVEL = INFO
```

## Deploy Settings

Ensure these settings in your Render service:

- **Auto-Deploy**: Off (recommended for production)
- **Root Directory**: . (root of repository)
- **Docker Command**: Not needed (using native Python)
- **Health Check Path**: / (or /health if you implement one)

## Post-Deployment Steps

1. **Check Logs**: Monitor the deploy logs for any errors
2. **Run Migrations**: Should happen automatically via build.sh
3. **Test Login**: Create first user account
4. **Load Data**: Use the admin interface or scripts to load your data

## Troubleshooting

### Database Connection Issues
- Ensure DATABASE_URL starts with `postgresql://` not `postgres://`
- Check if database is in same region as web service
- Verify database is active and not suspended

### Build Failures
- Check Python version compatibility (3.8+)
- Ensure all dependencies in requirements.txt
- Look for missing system packages

### Runtime Errors
- Check environment variables are set correctly
- Monitor logs for specific error messages
- Ensure database tables are created

## Security Notes

- Never commit .env files to repository
- Use Render's secret management for sensitive data
- Enable 2FA on your Render account
- Regularly rotate API keys 